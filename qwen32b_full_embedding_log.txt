/home/raymondli/.local/lib/python3.10/site-packages/awq/__init__.py:21: DeprecationWarning: 
I have left this message as the final dev message to help you transition.

Important Notice:
- AutoAWQ is officially deprecated and will no longer be maintained.
- The last tested configuration used Torch 2.6.0 and Transformers 4.51.3.
- If future versions of Transformers break AutoAWQ compatibility, please report the issue to the Transformers project.

Alternative:
- AutoAWQ has been adopted by the vLLM Project: https://github.com/vllm-project/llm-compressor

For further inquiries, feel free to reach out:
- X: https://x.com/casper_hansen_
- LinkedIn: https://www.linkedin.com/in/casper-hansen-804005170/

  warnings.warn(_FINAL_DEV_MESSAGE, category=DeprecationWarning, stacklevel=1)
================================================================================
QWEN2.5-32B-AWQ EMBEDDING EXTRACTION
================================================================================
Using PyTorch version: 2.6.0+cu124
Using Transformers version: 4.52.3
Available GPUs: 4

=== Loading Essays ===
✓ Loaded 9513 essays
Running on FULL dataset

=== Loading Qwen/Qwen2.5-32B-Instruct-AWQ ===
This will use 2 GPUs as configured in your VLLM setup...
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:02,  1.92it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:01<00:01,  1.92it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:02<00:01,  1.08it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:04<00:01,  1.20s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:05<00:00,  1.26s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:05<00:00,  1.09s/it]
✓ Model and tokenizer loaded successfully

Device mapping:
  model.embed_tokens: 0
  model.layers.0: 0
  model.layers.1: 0
  model.layers.2: 0
  model.layers.3: 0
  ...

=== Embedding Layer Info ===
Type: <class 'torch.nn.modules.sparse.Embedding'>
Vocab Size: 152064
Embedding Dimension: 5120

=== Extracting Embeddings ===
Processing 9513 essays in batches of 2...
Note: Embedding raw essays without instruction prefix for fair comparison
Processing batches:   0%|          | 0/4757 [00:00<?, ?it/s]Processing batches:   0%|          | 1/4757 [00:00<13:55,  5.69it/s]Processing batches:   0%|          | 6/4757 [00:00<03:17, 24.05it/s]Processing batches:   0%|          | 11/4757 [00:00<02:29, 31.76it/s]Processing batches:   0%|          | 16/4757 [00:00<02:09, 36.61it/s]Processing batches:   0%|          | 21/4757 [00:00<02:01, 39.12it/s]Processing batches:   1%|          | 26/4757 [00:00<01:57, 40.30it/s]Processing batches:   1%|          | 31/4757 [00:00<01:55, 41.06it/s]Processing batches:   1%|          | 36/4757 [00:00<01:53, 41.42it/s]Processing batches:   1%|          | 41/4757 [00:01<01:57, 40.20it/s]Processing batches:   1%|          | 46/4757 [00:01<01:52, 41.83it/s]Processing batches:   1%|          | 51/4757 [00:01<01:53, 41.58it/s]Processing batches:   1%|          | 56/4757 [00:01<01:54, 41.07it/s]Processing batches:   1%|▏         | 61/4757 [00:01<01:54, 41.00it/s]Processing batches:   1%|▏         | 66/4757 [00:01<01:55, 40.71it/s]Processing batches:   1%|▏         | 71/4757 [00:01<01:54, 40.90it/s]Processing batches:   2%|▏         | 76/4757 [00:01<01:52, 41.79it/s]Processing batches:   2%|▏         | 81/4757 [00:02<01:53, 41.29it/s]Processing batches:   2%|▏         | 86/4757 [00:02<01:53, 41.29it/s]Processing batches:   2%|▏         | 91/4757 [00:02<01:53, 41.11it/s]Processing batches:   2%|▏         | 96/4757 [00:02<01:50, 42.10it/s]Processing batches:   2%|▏         | 101/4757 [00:02<01:46, 43.66it/s]Processing batches:   2%|▏         | 107/4757 [00:02<01:36, 48.05it/s]Processing batches:   2%|▏         | 116/4757 [00:02<01:36, 47.92it/s]Processing batches:   3%|▎         | 121/4757 [00:02<01:37, 47.72it/s]Processing batches:   3%|▎         | 126/4757 [00:03<01:37, 47.54it/s]Processing batches:   3%|▎         | 131/4757 [00:03<01:37, 47.23it/s]Processing batches:   3%|▎         | 136/4757 [00:03<01:37, 47.27it/s]Processing batches:   3%|▎         | 144/4757 [00:03<01:22, 56.24it/s]Processing batches:   3%|▎         | 151/4757 [00:03<01:36, 47.76it/s]Processing batches:   3%|▎         | 157/4757 [00:03<01:30, 50.65it/s]Processing batches:   3%|▎         | 163/4757 [00:03<01:26, 52.92it/s]Processing batches:   4%|▎         | 171/4757 [00:03<01:34, 48.54it/s]Processing batches:   4%|▎         | 177/4757 [00:04<01:30, 50.52it/s]Processing batches:   4%|▍         | 183/4757 [00:04<01:27, 52.14it/s]Processing batches:   4%|▍         | 189/4757 [00:04<01:26, 52.79it/s]Processing batches:   4%|▍         | 195/4757 [00:04<01:24, 53.72it/s]Processing batches:   4%|▍         | 201/4757 [00:04<01:42, 44.39it/s]Processing batches:   4%|▍         | 211/4757 [00:04<01:36, 47.18it/s]Processing batches:   5%|▍         | 221/4757 [00:04<01:33, 48.42it/s]Processing batches:   5%|▍         | 226/4757 [00:05<01:34, 47.91it/s]Processing batches:   5%|▍         | 232/4757 [00:05<01:29, 50.52it/s]Processing batches:   5%|▌         | 241/4757 [00:05<01:32, 49.07it/s]Processing batches:   5%|▌         | 249/4757 [00:05<01:20, 55.85it/s]Processing batches:   5%|▌         | 256/4757 [00:05<01:31, 49.02it/s]Processing batches:   6%|▌         | 266/4757 [00:05<01:30, 49.73it/s]Processing batches:   6%|▌         | 272/4757 [00:05<01:28, 50.62it/s]Processing batches:   6%|▌         | 278/4757 [00:06<01:31, 49.09it/s]Processing batches:   6%|▌         | 284/4757 [00:06<01:29, 50.18it/s]Processing batches:   6%|▌         | 290/4757 [00:06<01:25, 51.98it/s]Processing batches:   6%|▌         | 296/4757 [00:06<01:46, 41.96it/s]Processing batches:   6%|▋         | 301/4757 [00:06<01:43, 42.90it/s]Processing batches:   6%|▋         | 306/4757 [00:06<01:41, 43.93it/s]Processing batches:   7%|▋         | 311/4757 [00:06<01:38, 45.05it/s]Processing batches:   7%|▋         | 321/4757 [00:07<01:34, 47.02it/s]Processing batches:   7%|▋         | 326/4757 [00:07<01:37, 45.68it/s]Processing batches:   7%|▋         | 331/4757 [00:07<01:37, 45.23it/s]Processing batches:   7%|▋         | 336/4757 [00:07<01:37, 45.20it/s]Processing batches:   7%|▋         | 341/4757 [00:07<01:38, 44.70it/s]Processing batches:   7%|▋         | 346/4757 [00:07<01:38, 44.62it/s]Processing batches:   7%|▋         | 351/4757 [00:07<01:39, 44.47it/s]Processing batches:   7%|▋         | 356/4757 [00:07<01:40, 43.79it/s]Processing batches:   8%|▊         | 361/4757 [00:07<01:40, 43.82it/s]Processing batches:   8%|▊         | 366/4757 [00:08<01:42, 42.96it/s]Processing batches:   8%|▊         | 371/4757 [00:08<01:43, 42.25it/s]Processing batches:   8%|▊         | 376/4757 [00:08<01:45, 41.72it/s]Processing batches:   8%|▊         | 381/4757 [00:08<01:41, 42.92it/s]Processing batches:   8%|▊         | 386/4757 [00:08<01:39, 43.81it/s]Processing batches:   8%|▊         | 391/4757 [00:08<01:39, 43.99it/s]Processing batches:   8%|▊         | 396/4757 [00:08<01:40, 43.47it/s]Processing batches:   8%|▊         | 401/4757 [00:08<01:41, 42.97it/s]Processing batches:   9%|▊         | 406/4757 [00:09<01:45, 41.43it/s]Processing batches:   9%|▊         | 411/4757 [00:09<01:42, 42.20it/s]Processing batches:   9%|▊         | 416/4757 [00:09<01:42, 42.47it/s]Processing batches:   9%|▉         | 421/4757 [00:09<01:41, 42.84it/s]Processing batches:   9%|▉         | 426/4757 [00:09<01:41, 42.71it/s]Processing batches:   9%|▉         | 431/4757 [00:09<01:42, 42.21it/s]Processing batches:   9%|▉         | 436/4757 [00:09<01:42, 42.19it/s]Processing batches:   9%|▉         | 441/4757 [00:09<01:39, 43.18it/s]Processing batches:   9%|▉         | 446/4757 [00:09<01:37, 44.10it/s]Processing batches:   9%|▉         | 451/4757 [00:10<01:41, 42.33it/s]Processing batches:  10%|▉         | 456/4757 [00:10<01:41, 42.22it/s]Processing batches:  10%|▉         | 461/4757 [00:10<01:40, 42.54it/s]Processing batches:  10%|▉         | 466/4757 [00:10<01:39, 43.18it/s]Processing batches:  10%|▉         | 471/4757 [00:10<01:38, 43.61it/s]Processing batches:  10%|█         | 476/4757 [00:10<01:34, 45.12it/s]Processing batches:  10%|█         | 481/4757 [00:10<01:37, 44.06it/s]Processing batches:  10%|█         | 486/4757 [00:10<01:38, 43.27it/s]Processing batches:  10%|█         | 491/4757 [00:10<01:39, 43.07it/s]Processing batches:  10%|█         | 496/4757 [00:11<01:38, 43.11it/s]Processing batches:  11%|█         | 501/4757 [00:11<01:34, 44.92it/s]Processing batches:  11%|█         | 508/4757 [00:11<01:21, 51.82it/s]Processing batches:  11%|█         | 514/4757 [00:11<01:21, 52.30it/s]Processing batches:  11%|█         | 520/4757 [00:11<01:19, 53.16it/s]Processing batches:  11%|█         | 526/4757 [00:11<01:38, 43.16it/s]Processing batches:  11%|█         | 531/4757 [00:11<01:36, 43.99it/s]Processing batches:  11%|█▏        | 536/4757 [00:11<01:35, 44.15it/s]Processing batches:  11%|█▏        | 541/4757 [00:12<01:33, 45.09it/s]Processing batches:  11%|█▏        | 546/4757 [00:12<01:30, 46.39it/s]Processing batches:  12%|█▏        | 552/4757 [00:12<01:24, 49.97it/s]Processing batches:  12%|█▏        | 558/4757 [00:12<01:23, 50.57it/s]Processing batches:  12%|█▏        | 564/4757 [00:12<01:20, 52.39it/s]Processing batches:  12%|█▏        | 570/4757 [00:12<01:19, 52.79it/s]Processing batches:  12%|█▏        | 576/4757 [00:12<01:35, 43.94it/s]Processing batches:  12%|█▏        | 581/4757 [00:12<01:32, 45.02it/s]Processing batches:  12%|█▏        | 587/4757 [00:12<01:25, 48.65it/s]Processing batches:  12%|█▏        | 593/4757 [00:13<01:21, 51.36it/s]Processing batches:  13%|█▎        | 599/4757 [00:13<01:18, 53.03it/s]Processing batches:  13%|█▎        | 606/4757 [00:13<01:31, 45.48it/s]Processing batches:  13%|█▎        | 614/4757 [00:13<01:17, 53.65it/s]Processing batches:  13%|█▎        | 621/4757 [00:13<01:27, 47.16it/s]Processing batches:  13%|█▎        | 627/4757 [00:13<01:24, 48.90it/s]Processing batches:  13%|█▎        | 633/4757 [00:13<01:20, 51.48it/s]Processing batches:  13%|█▎        | 639/4757 [00:13<01:16, 53.57it/s]Processing batches:  14%|█▎        | 645/4757 [00:14<01:15, 54.45it/s]Processing batches:  14%|█▎        | 651/4757 [00:14<01:31, 44.64it/s]Processing batches:  14%|█▍        | 657/4757 [00:14<01:25, 48.07it/s]Processing batches:  14%|█▍        | 666/4757 [00:14<01:28, 46.47it/s]Processing batches:  14%|█▍        | 671/4757 [00:14<01:26, 47.07it/s]Processing batches:  14%|█▍        | 676/4757 [00:14<01:26, 47.31it/s]Processing batches:  14%|█▍        | 683/4757 [00:14<01:16, 53.01it/s]Processing batches:  14%|█▍        | 689/4757 [00:14<01:15, 54.15it/s]Processing batches:  15%|█▍        | 695/4757 [00:15<01:14, 54.37it/s]Processing batches:  15%|█▍        | 701/4757 [00:15<01:34, 43.11it/s]Processing batches:  15%|█▍        | 706/4757 [00:15<01:32, 43.99it/s]Processing batches:  15%|█▍        | 711/4757 [00:15<01:31, 43.99it/s]Processing batches:  15%|█▌        | 716/4757 [00:15<01:30, 44.57it/s]Processing batches:  15%|█▌        | 721/4757 [00:15<01:28, 45.50it/s]Processing batches:  15%|█▌        | 726/4757 [00:15<01:27, 46.11it/s]Processing batches:  15%|█▌        | 733/4757 [00:15<01:16, 52.59it/s]Processing batches:  16%|█▌        | 739/4757 [00:16<01:16, 52.48it/s]Processing batches:  16%|█▌        | 745/4757 [00:16<01:18, 51.42it/s]Processing batches:  16%|█▌        | 751/4757 [00:16<01:36, 41.34it/s]Processing batches:  16%|█▌        | 756/4757 [00:16<01:34, 42.21it/s]Processing batches:  16%|█▌        | 761/4757 [00:16<01:34, 42.51it/s]Processing batches:  16%|█▌        | 766/4757 [00:16<01:35, 41.95it/s]Processing batches:  16%|█▌        | 771/4757 [00:16<01:34, 42.13it/s]Processing batches:  16%|█▋        | 776/4757 [00:16<01:34, 42.22it/s]Processing batches:  16%|█▋        | 781/4757 [00:17<01:31, 43.28it/s]Processing batches:  17%|█▋        | 786/4757 [00:17<01:29, 44.14it/s]Processing batches:  17%|█▋        | 791/4757 [00:17<01:29, 44.44it/s]Processing batches:  17%|█▋        | 796/4757 [00:17<01:27, 45.16it/s]Processing batches:  17%|█▋        | 802/4757 [00:17<01:20, 49.15it/s]Processing batches:  17%|█▋        | 807/4757 [00:17<01:21, 48.47it/s]Processing batches:  17%|█▋        | 812/4757 [00:17<01:22, 48.00it/s]Processing batches:  17%|█▋        | 817/4757 [00:17<01:21, 48.10it/s]Processing batches:  17%|█▋        | 822/4757 [00:17<01:24, 46.79it/s]Processing batches:  17%|█▋        | 827/4757 [00:18<01:24, 46.40it/s]Processing batches:  17%|█▋        | 832/4757 [00:18<01:24, 46.59it/s]Processing batches:  18%|█▊        | 837/4757 [00:18<01:24, 46.35it/s]Processing batches:  18%|█▊        | 842/4757 [00:18<01:25, 45.79it/s]Processing batches:  18%|█▊        | 847/4757 [00:18<01:24, 46.13it/s]Processing batches:  18%|█▊        | 853/4757 [00:18<01:18, 49.98it/s]Processing batches:  18%|█▊        | 861/4757 [00:18<01:25, 45.48it/s]Processing batches:  18%|█▊        | 866/4757 [00:18<01:24, 45.98it/s]Processing batches:  18%|█▊        | 871/4757 [00:19<01:25, 45.44it/s]Processing batches:  18%|█▊        | 876/4757 [00:19<01:25, 45.52it/s]Processing batches:  19%|█▊        | 881/4757 [00:19<01:23, 46.66it/s]Processing batches:  19%|█▊        | 886/4757 [00:19<01:23, 46.55it/s]Processing batches:  19%|█▊        | 891/4757 [00:19<01:22, 46.62it/s]Processing batches:  19%|█▉        | 900/4757 [00:19<01:05, 58.62it/s]Processing batches:  19%|█▉        | 906/4757 [00:19<01:27, 44.03it/s]Processing batches:  19%|█▉        | 911/4757 [00:19<01:25, 44.88it/s]Processing batches:  19%|█▉        | 918/4757 [00:19<01:15, 51.01it/s]Processing batches:  19%|█▉        | 924/4757 [00:20<01:12, 52.52it/s]Processing batches:  20%|█▉        | 930/4757 [00:20<01:11, 53.64it/s]Processing batches:  20%|█▉        | 936/4757 [00:20<01:28, 42.94it/s]Processing batches:  20%|█▉        | 941/4757 [00:20<01:25, 44.52it/s]Processing batches:  20%|█▉        | 946/4757 [00:20<01:23, 45.41it/s]Processing batches:  20%|█▉        | 951/4757 [00:20<01:21, 46.51it/s]Processing batches:  20%|██        | 956/4757 [00:20<01:21, 46.92it/s]Processing batches:  20%|██        | 961/4757 [00:20<01:19, 47.58it/s]Processing batches:  20%|██        | 967/4757 [00:20<01:14, 50.98it/s]Processing batches:  20%|██        | 973/4757 [00:21<01:14, 50.94it/s]Processing batches:  21%|██        | 979/4757 [00:21<01:12, 51.85it/s]Processing batches:  21%|██        | 985/4757 [00:21<01:11, 52.44it/s]Processing batches:  21%|██        | 991/4757 [00:21<01:29, 41.92it/s]Processing batches:  21%|██        | 996/4757 [00:21<01:29, 41.96it/s]Processing batches:  21%|██        | 1001/4757 [00:21<01:28, 42.38it/s]Processing batches:  21%|██        | 1006/4757 [00:21<01:27, 42.67it/s]Processing batches:  21%|██▏       | 1011/4757 [00:22<01:28, 42.56it/s]Processing batches:  21%|██▏       | 1016/4757 [00:22<01:27, 42.72it/s]Processing batches:  21%|██▏       | 1021/4757 [00:22<01:24, 44.32it/s]Processing batches:  22%|██▏       | 1026/4757 [00:22<01:23, 44.95it/s]Processing batches:  22%|██▏       | 1031/4757 [00:22<01:21, 45.90it/s]Processing batches:  22%|██▏       | 1036/4757 [00:22<01:20, 46.20it/s]Processing batches:  22%|██▏       | 1042/4757 [00:22<01:14, 50.01it/s]Processing batches:  22%|██▏       | 1048/4757 [00:22<01:11, 51.84it/s]Processing batches:  22%|██▏       | 1056/4757 [00:22<01:19, 46.34it/s]Processing batches:  22%|██▏       | 1061/4757 [00:23<01:21, 45.23it/s]Processing batches:  22%|██▏       | 1066/4757 [00:23<01:20, 45.81it/s]Processing batches:  23%|██▎       | 1071/4757 [00:23<01:19, 46.56it/s]Processing batches:  23%|██▎       | 1076/4757 [00:23<01:19, 46.56it/s]Processing batches:  23%|██▎       | 1083/4757 [00:23<01:09, 52.89it/s]Processing batches:  23%|██▎       | 1091/4757 [00:23<01:16, 48.10it/s]Processing batches:  23%|██▎       | 1097/4757 [00:23<01:13, 49.91it/s]Processing batches:  23%|██▎       | 1103/4757 [00:23<01:10, 51.54it/s]Processing batches:  23%|██▎       | 1109/4757 [00:23<01:08, 53.26it/s]Processing batches:  23%|██▎       | 1115/4757 [00:24<01:07, 54.35it/s]Processing batches:  24%|██▎       | 1121/4757 [00:24<01:22, 43.87it/s]Processing batches:  24%|██▎       | 1128/4757 [00:24<01:12, 50.02it/s]Processing batches:  24%|██▍       | 1134/4757 [00:24<01:09, 52.28it/s]Processing batches:  24%|██▍       | 1140/4757 [00:24<01:07, 53.21it/s]Processing batches:  24%|██▍       | 1146/4757 [00:24<01:22, 43.63it/s]Processing batches:  24%|██▍       | 1151/4757 [00:24<01:20, 44.52it/s]Processing batches:  24%|██▍       | 1156/4757 [00:25<01:20, 44.93it/s]Processing batches:  24%|██▍       | 1161/4757 [00:25<01:22, 43.55it/s]Processing batches:  25%|██▍       | 1166/4757 [00:25<01:23, 43.23it/s]Processing batches:  25%|██▍       | 1171/4757 [00:25<01:22, 43.52it/s]Processing batches:  25%|██▍       | 1176/4757 [00:25<01:22, 43.64it/s]Processing batches:  25%|██▍       | 1181/4757 [00:25<01:22, 43.21it/s]Processing batches:  25%|██▍       | 1186/4757 [00:25<01:21, 43.63it/s]Processing batches:  25%|██▌       | 1191/4757 [00:25<01:21, 43.51it/s]Processing batches:  25%|██▌       | 1196/4757 [00:25<01:20, 43.99it/s]Processing batches:  25%|██▌       | 1201/4757 [00:26<01:22, 43.26it/s]Processing batches:  25%|██▌       | 1206/4757 [00:26<01:22, 42.98it/s]Processing batches:  25%|██▌       | 1211/4757 [00:26<01:21, 43.78it/s]Processing batches:  26%|██▌       | 1217/4757 [00:26<01:13, 48.03it/s]Processing batches:  26%|██▌       | 1226/4757 [00:26<01:14, 47.43it/s]Processing batches:  26%|██▌       | 1231/4757 [00:26<01:13, 48.03it/s]Processing batches:  26%|██▌       | 1236/4757 [00:26<01:13, 48.20it/s]Processing batches:  26%|██▌       | 1243/4757 [00:26<01:05, 53.96it/s]Processing batches:  26%|██▋       | 1249/4757 [00:26<01:03, 55.57it/s]Processing batches:  26%|██▋       | 1255/4757 [00:27<01:02, 56.04it/s]Processing batches:  27%|██▋       | 1261/4757 [00:27<01:20, 43.25it/s]